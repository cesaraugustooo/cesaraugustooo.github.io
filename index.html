<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Comparador de Matrizes</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }

    .form-section, .matrizes, .resultado {
      margin-bottom: 30px;
    }

    label {
      margin-right: 10px;
    }

    input[type="number"], input[type="text"] {
      width: 60px;
      margin-right: 10px;
    }

    table {
      border-collapse: collapse;
      margin: 10px 0;
    }

    td {
      border: 1px solid #444;
      padding: 10px;
      text-align: center;
      min-width: 40px;
    }

    .matriz-container {
      margin-bottom: 20px;
      border: 1px solid #ccc;
      padding: 10px;
    }

    .checkbox {
      margin-top: 10px;
    }

    button {
      padding: 10px 20px;
      margin-top: 10px;
      cursor: pointer;
    }

    .igual {
      background-color: #d4edda;
    }

    .diferente {
      background-color: #f8d7da;
    }
  </style>
</head>
<body>

  <h1>Comparador de Matrizes</h1>

  <div class="form-section">
    <label>Linhas: <input type="number" id="linhas" min="1"></label>
    <label>Colunas: <input type="number" id="colunas" min="1"></label>
    <button onclick="criarFormulario()">Criar matriz</button>
  </div>

  <div id="formulario-matriz"></div>

  <div class="matrizes" id="matrizes"></div>

  <button onclick="compararMatrizes()">Comparar Matrizes</button>

  <div class="resultado" id="resultado"></div>

  <script>
    let matrizCount = 0;
    const matrizes = [];

    function criarFormulario() {
      const linhas = parseInt(document.getElementById("linhas").value);
      const colunas = parseInt(document.getElementById("colunas").value);
      const container = document.getElementById("formulario-matriz");

      if (linhas <= 0 || colunas <= 0 || isNaN(linhas) || isNaN(colunas)) {
        alert("Informe valores válidos para linhas e colunas.");
        return;
      }

      let html = '<h3>Preencha os valores da matriz (ex: 3+5)</h3><table>';
      for (let i = 0; i < linhas; i++) {
        html += '<tr>';
        for (let j = 0; j < colunas; j++) {
          html += `<td><input type="text" name="cell" data-i="${i}" data-j="${j}" required></td>`;
        }
        html += '</tr>';
      }
      html += '</table><button onclick="salvarMatriz()">Salvar matriz</button>';

      container.innerHTML = html;
      container.dataset.linhas = linhas;
      container.dataset.colunas = colunas;
    }

    function salvarMatriz() {
      const container = document.getElementById("formulario-matriz");
      const inputs = container.querySelectorAll('input[name="cell"]');
      const linhas = parseInt(container.dataset.linhas);
      const colunas = parseInt(container.dataset.colunas);
      const matriz = [];

      for (let i = 0; i < linhas; i++) {
        const row = [];
        for (let j = 0; j < colunas; j++) {
          const input = Array.from(inputs).find(el => +el.dataset.i === i && +el.dataset.j === j);
          const expressao = input.value.trim();
          try {
            const valor = eval(expressao);
            if (isNaN(valor)) throw "Inválido";
            row.push({ expressao, valor });
          } catch {
            alert(`Expressão inválida em (${i+1}, ${j+1}): "${expressao}"`);
            return;
          }
        }
        matriz.push(row);
      }

      matrizes.push({ id: matrizCount++, dados: matriz });
      exibirMatriz(matriz, matrizCount - 1);
      document.getElementById("formulario-matriz").innerHTML = '';
    }

    function exibirMatriz(matriz, id) {
      const div = document.getElementById("matrizes");
      const container = document.createElement("div");
      container.className = "matriz-container";
      container.innerHTML = `<strong>Matriz ${id}</strong><br><table>`;

      matriz.forEach(linha => {
        const row = document.createElement("tr");
        linha.forEach(celula => {
          const cell = document.createElement("td");
          cell.textContent = celula.expressao; // mostrar a expressão original
          row.appendChild(cell);
        });
        container.querySelector("table").appendChild(row);
      });

      container.innerHTML += `<div class="checkbox"><label><input type="checkbox" value="${id}"> Selecionar</label></div>`;
      div.appendChild(container);
    }

    function compararMatrizes() {
      const selecionadas = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(cb => parseInt(cb.value));
      const resultadoDiv = document.getElementById("resultado");
      resultadoDiv.innerHTML = '';

      if (selecionadas.length !== 2) {
        alert("Selecione exatamente duas matrizes para comparar.");
        return;
      }

      const [m1, m2] = [matrizes.find(m => m.id === selecionadas[0]), matrizes.find(m => m.id === selecionadas[1])];

      if (m1.dados.length !== m2.dados.length || m1.dados[0].length !== m2.dados[0].length) {
        resultadoDiv.innerHTML = '<p style="color: red;">As matrizes não têm as mesmas dimensões.</p>';
        return;
      }

      let iguais = true;
      let comparacaoHTML = '<h3>Comparação de valores:</h3><table>';

      for (let i = 0; i < m1.dados.length; i++) {
        comparacaoHTML += '<tr>';
        for (let j = 0; j < m1.dados[0].length; j++) {
          const val1 = m1.dados[i][j].valor;
          const val2 = m2.dados[i][j].valor;
          const expr1 = m1.dados[i][j].expressao;
          const expr2 = m2.dados[i][j].expressao;

          if (val1 === val2) {
            comparacaoHTML += `<td class="igual">${expr1}</td>`;
          } else {
            comparacaoHTML += `<td class="diferente">${expr1} ≠ ${expr2}</td>`;
            iguais = false;
          }
        }
        comparacaoHTML += '</tr>';
      }

      comparacaoHTML += '</table>';
      comparacaoHTML += `<p><strong>Resultado:</strong> ${iguais ? "As matrizes são completamente iguais." : "As matrizes NÃO são completamente iguais."}</p>`;

      resultadoDiv.innerHTML = comparacaoHTML;
    }
  </script>

</body>
</html>
